# modeInit 函数优化修改计划

## 问题分析

**当前问题：**
- modeInit 函数已更新，支持指定 `deselectMode` 参数来选择正确的清空选择操作
- 但 RIG.py 中的调用没有正确传递该参数
- 导致在 POSE 模式下可能使用错误的 `bpy.ops.object.select_all` 操作

**参考标准：**
根据 `源码_RIG.py` 文件的逻辑，应该按照以下规则：

| 模式 | 清空选择操作 |
|------|------------|
| OBJECT | `bpy.ops.object.select_all(action='DESELECT')` |
| EDIT | `bpy.ops.object.select_all(action='DESELECT')` |
| POSE | `bpy.ops.pose.select_all(action='DESELECT')` |

## 修改方案

### 步骤 1：修改模式切换的 modeInit 调用

**需要修改的调用（POSE 模式）：**

| 行号  | 当前调用            | 建议修改                            | 原因                    |
|------|------------------|---------------------------------|------------------------|
| 423  | `modeInit('POSE')` | `modeInit('POSE', deselectMode="pose")` | 在 POSE 模式下应使用 pose 清空选择 |

### 步骤 2：优化未优化的代码

**需要修改的重复代码：**

| 行号范围 | 当前代码模式                  | 建议修改                  | 原因          |
|---------|---------------------------|------------------------|-------------|
| 多处    | 模式切换后立即清空选择（两行分开） | 使用 modeInit 单一调用      | 减少代码重复，提高一致性 |

### 步骤 3：确保函数调用一致性

**验证所有 modeInit 调用：**

- ✅ OBJECT 模式：保持默认 `deselectMode="object"`
- ✅ EDIT 模式：保持默认 `deselectMode="object"`
- ❌ POSE 模式：需要指定 `deselectMode="pose"`

## 预期效果

- ✅ 修复 POSE 模式下的清空选择错误
- ✅ 统一模式切换和清空选择的操作
- ✅ 减少代码重复
- ✅ 提高代码可读性和维护性

